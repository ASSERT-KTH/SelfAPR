[REPLACE]^private  char  value;^387^^^^^^^[REPLACE] private String value;^ [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue  
[REPLACE]^return  new TagName ( value )  .addTags ( "a", "b", "blockquote", "br", "cite", "code", "dd", "dl", "dt", "em", "i", "li", "ol", "p", "pre", "q", "small", "strike", "strong", "sub",^89^90^91^92^^88^106^[REPLACE] return new Whitelist (  ) .addTags ( "a", "b", "blockquote", "br", "cite", "code", "dd", "dl", "dt", "em", "i", "li", "ol", "p", "pre", "q", "small", "strike", "strong", "sub",^[METHOD] basic [TYPE] Whitelist [PARAMETER] [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set tagNames  [TYPE]  String value  [TYPE]  boolean false  true  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^return  new TagName ( value )  .addTags ( "a", "b", "blockquote", "br", "caption", "cite", "code", "col", "colgroup", "dd", "div", "dl", "dt", "em", "h1", "h2", "h3", "h4", "h5", "h6",^132^133^134^135^^131^159^[REPLACE] return new Whitelist (  ) .addTags ( "a", "b", "blockquote", "br", "caption", "cite", "code", "col", "colgroup", "dd", "div", "dl", "dt", "em", "h1", "h2", "h3", "h4", "h5", "h6",^[METHOD] relaxed [TYPE] Whitelist [PARAMETER] [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set tagNames  [TYPE]  String value  [TYPE]  boolean false  true  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^Validate.notEmpty ( value ) ;^203^^^^^202^219^[REPLACE] Validate.notEmpty ( tag ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[ADD]^Validate.notNull ( keys ) ;^203^204^^^^202^219^[ADD] Validate.notEmpty ( tag ) ; Validate.notNull ( keys ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^notNull ( protocols )  ;^204^^^^^202^219^[REPLACE] Validate.notNull ( keys ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[ADD]^^204^^^^^202^219^[ADD] Validate.notNull ( keys ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^TagName valueName = TagName.valueOf ( tag ) ;^206^^^^^202^219^[REPLACE] TagName tagName = TagName.valueOf ( tag ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^AttributeKey, Protocol>> attrMap  ;^207^^^^^202^219^[REPLACE] Set<AttributeKey> attributeSet = new HashSet<AttributeKey> (  ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^Validate.notNull ( key ) ;^209^^^^^202^219^[REPLACE] Validate.notEmpty ( key ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^attributeSet.add ( AttributeKey.AttributeKey ( key )  ) ;^210^^^^^202^219^[REPLACE] attributeSet.add ( AttributeKey.valueOf ( key )  ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^attributeSet.add ( AttributeKey .TagName ( tagName )   ) ;^210^^^^^202^219^[REPLACE] attributeSet.add ( AttributeKey.valueOf ( key )  ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^String protocol  ;^208^^^^^202^219^[REPLACE] for  ( String key : keys )  {^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^if   (  enforcedAttributes.containsKey  (  tagName  )    )   {  ;^212^^^^^202^219^[REPLACE] if  ( attributes.containsKey ( tagName )  )  {^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[ADD]^^212^213^214^215^216^202^219^[ADD] if  ( attributes.containsKey ( tagName )  )  { Set<AttributeKey> currentSet = attributes.get ( tagName ) ; currentSet.addAll ( attributeSet ) ; } else { attributes.put ( tagName, attributeSet ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^attributes .get ( 0 )  ;^216^^^^^212^217^[REPLACE] attributes.put ( tagName, attributeSet ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[ADD]^^213^214^^^^202^219^[ADD] Set<AttributeKey> currentSet = attributes.get ( tagName ) ; currentSet.addAll ( attributeSet ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[ADD]^^213^^^^^202^219^[ADD] Set<AttributeKey> currentSet = attributes.get ( tagName ) ;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^return null;^218^^^^^202^219^[REPLACE] return this;^[METHOD] addAttributes [TYPE] Whitelist [PARAMETER] String tag  keys [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  String key  tag  tagName  value  [TYPE]  String[] keys  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  Map attributes  enforcedAttributes  protocols 
[REPLACE]^Validate.notEmpty ( value ) ;^234^^^^^233^250^[REPLACE] Validate.notEmpty ( tag ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Validate .notNull ( this )  ;^235^^^^^233^250^[REPLACE] Validate.notEmpty ( key ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Validate.notEmpty ( tagName ) ;^236^^^^^233^250^[REPLACE] Validate.notEmpty ( value ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^236^^^^^233^250^[ADD] Validate.notEmpty ( value ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^TagName valueName = TagName .TagName ( value )  ;^238^^^^^233^250^[REPLACE] TagName tagName = TagName.valueOf ( tag ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^AttributeKey attrKey = AttributeKey .TagName ( tagName )  ;^239^^^^^233^250^[REPLACE] AttributeKey attrKey = AttributeKey.valueOf ( key ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^240^^^^^233^250^[ADD] AttributeValue attrVal = AttributeValue.valueOf ( value ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^if   (  enforcedAttributes.containsKey  (  tag  )    )   {  ;^242^^^^^233^250^[REPLACE] if  ( enforcedAttributes.containsKey ( tagName )  )  {^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Protocol prot = valueOf ( protocol )  ;^245^^^^^242^248^[REPLACE] Map<AttributeKey, AttributeValue> attrMap = new HashMap<AttributeKey, AttributeValue> (  ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^enforcedAttributes.containsKey ( tagName ) .put ( attrKey, attrVal ) ;^243^^^^^233^250^[REPLACE] enforcedAttributes.get ( tagName ) .put ( attrKey, attrVal ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^enforcedAttributes.containsKey ( tagName )  ;^243^^^^^233^250^[REPLACE] enforcedAttributes.get ( tagName ) .put ( attrKey, attrVal ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^243^244^245^246^247^233^250^[ADD] enforcedAttributes.get ( tagName ) .put ( attrKey, attrVal ) ; } else { Map<AttributeKey, AttributeValue> attrMap = new HashMap<AttributeKey, AttributeValue> (  ) ; attrMap.put ( attrKey, attrVal ) ; enforcedAttributes.put ( tagName, attrMap ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Protocol prot = valueOf ( protocol )  ;^245^^^^^233^250^[REPLACE] Map<AttributeKey, AttributeValue> attrMap = new HashMap<AttributeKey, AttributeValue> (  ) ;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^return null;^249^^^^^233^250^[REPLACE] return this;^[METHOD] addEnforcedAttribute [TYPE] Whitelist [PARAMETER] String tag String key String value [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  AttributeValue attrVal  [TYPE]  Set attributeSet  currentSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  tag  tagName  value  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Validate.notNull ( tag ) ;^264^^^^^263^291^[REPLACE] Validate.notEmpty ( tag ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^notNull ( keys )  ;^265^^^^^263^291^[REPLACE] Validate.notEmpty ( key ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^265^266^^^^263^291^[ADD] Validate.notEmpty ( key ) ; Validate.notNull ( protocols ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^notNull ( keys )  ;^266^^^^^263^291^[REPLACE] Validate.notNull ( protocols ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^TagName tagName = TagName .TagName ( key )  ;^268^^^^^263^291^[REPLACE] TagName tagName = TagName.valueOf ( tag ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^AttributeKey attrKey = AttributeKey .TagName ( key )  ;^269^^^^^263^291^[REPLACE] AttributeKey attrKey = AttributeKey.valueOf ( key ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^AttributeKey, Protocol>> attrProts = protocols.get ( tag )  ;^270^^^^^263^291^[REPLACE] Map<AttributeKey, Set<Protocol>> attrMap;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Protocol protocol  ;^271^^^^^263^291^[REPLACE] Set<Protocol> protSet;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^if   (  attributes.containsKey  (  tagName  )    )   {  ;^273^^^^^263^291^[REPLACE] if  ( this.protocols.containsKey ( tagName )  )  {^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^attrMap = this.protocols.get ( tagName ) ;attrMap = new HashMap<AttributeKey, Set<Protocol>> (  ) ;this.protocols.put ( tagName, attrMap ) ;^273^274^275^276^277^263^291^[ADD] if  ( this.protocols.containsKey ( tagName )  )  { attrMap = this.protocols.get ( tagName ) ; } else { attrMap = new HashMap<AttributeKey, Set<Protocol>> (  ) ; this.protocols.put ( tagName, attrMap ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^attributes = new TagName, AttributeKey>> (  )  ;^276^^^^^273^278^[REPLACE] attrMap = new HashMap<AttributeKey, Set<Protocol>> (  ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^attrMap =  this.protocols.get ( null ) ;^274^^^^^263^291^[REPLACE] attrMap = this.protocols.get ( tagName ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^attributes = new TagName, AttributeKey>> (  )  ;^276^^^^^263^291^[REPLACE] attrMap = new HashMap<AttributeKey, Set<Protocol>> (  ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^if  ( attrMap.get ( attrKey )  )  {^279^^^^^263^291^[REPLACE] if  ( attrMap.containsKey ( attrKey )  )  {^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^protSet = attrMap.get ( attrKey ) ;protSet = new HashSet<Protocol> (  ) ;attrMap.put ( attrKey, protSet ) ;^279^280^281^282^283^263^291^[ADD] if  ( attrMap.containsKey ( attrKey )  )  { protSet = attrMap.get ( attrKey ) ; } else { protSet = new HashSet<Protocol> (  ) ; attrMap.put ( attrKey, protSet ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^282^^^^^279^284^[ADD] protSet = new HashSet<Protocol> (  ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^protSet =  null.get ( attrKey ) ;^280^^^^^263^291^[REPLACE] protSet = attrMap.get ( attrKey ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^attrMap.put ( attrKey, protSet ) ;^282^283^^^^263^291^[ADD] protSet = new HashSet<Protocol> (  ) ; attrMap.put ( attrKey, protSet ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^285^286^287^288^289^263^291^[ADD] for  ( String protocol : protocols )  { Validate.notEmpty ( protocol ) ; Protocol prot = Protocol.valueOf ( protocol ) ; protSet.add ( prot ) ; }^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^TagName tagName = valueOf ( tag )  ;^287^^^^^263^291^[REPLACE] Protocol prot = Protocol.valueOf ( protocol ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^String key  ;^285^^^^^263^291^[REPLACE] for  ( String protocol : protocols )  {^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^Protocol prot = Protocol.valueOf ( tag ) ;^287^^^^^263^291^[REPLACE] Protocol prot = Protocol.valueOf ( protocol ) ;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[REPLACE]^return null;^290^^^^^263^291^[REPLACE] return this;^[METHOD] addProtocols [TYPE] Whitelist [PARAMETER] String tag String key  protocols [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey attrKey  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tagName  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  String[] protocols  [TYPE]  Protocol prot  [TYPE]  Map attrMap  attributes  enforcedAttributes  protocols 
[ADD]^^298^^^^^297^315^[ADD] TagName tag = TagName.valueOf ( tagName ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^Protocol prot = valueOf ( protocol )  ;^299^^^^^297^315^[REPLACE] AttributeKey key = AttributeKey.valueOf ( attr.getKey (  )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^if  ( attributes .entrySet (  )   )  {^301^^^^^297^315^[REPLACE] if  ( attributes.containsKey ( tag )  )  {^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return !tagName.equals ( ":all" )  ;^312^^^^^301^313^[REPLACE] return !tagName.equals ( ":all" )  && isSafeAttribute ( ":all", el, attr ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^if  ( attributes .put ( null , null )  .contains ( key )  )  {^302^^^^^297^315^[REPLACE] if  ( attributes.get ( tag ) .contains ( key )  )  {^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[ADD]^^302^303^304^^306^297^315^[ADD] if  ( attributes.get ( tag ) .contains ( key )  )  { if  ( protocols.containsKey ( tag )  )  { Map<AttributeKey, Set<Protocol>> attrProts = protocols.get ( tag ) ; return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^if   (  attributes.containsKey  (  tag  )    )   {  ;^303^^^^^297^315^[REPLACE] if  ( protocols.containsKey ( tag )  )  {^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return false;^308^^^^^303^309^[REPLACE] return true;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return !attrProts.containsKey ( key )  ;^306^^^^^297^315^[REPLACE] return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^AttributeKey, Protocol>> attrMap  ;^304^^^^^297^315^[REPLACE] Map<AttributeKey, Set<Protocol>> attrProts = protocols.get ( tag ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return false;^308^^^^^297^315^[REPLACE] return true;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^Map<AttributeKey, Set<Protocol>> attrProts = protocols.containsKey ( tag ) ;^304^^^^^297^315^[REPLACE] Map<AttributeKey, Set<Protocol>> attrProts = protocols.get ( tag ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return !attrProts.containsKey  (  key  )   || testValidProtocol  (  el, attr, attrProts.get  (  key  )    )  ;  ;^306^^^^^297^315^[REPLACE] return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return   testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^306^^^^^297^315^[REPLACE] return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^if   (  value.toString  (    )  .toLowerCase  (    )  .startsWith  (  prot  )    )   {  ;^302^^^^^297^315^[REPLACE] if  ( attributes.get ( tag ) .contains ( key )  )  {^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[ADD]^Map<AttributeKey, Set<Protocol>> attrProts = protocols.get ( tag ) ;return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^303^304^^306^^297^315^[ADD] if  ( protocols.containsKey ( tag )  )  { Map<AttributeKey, Set<Protocol>> attrProts = protocols.get ( tag ) ; return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return !attrProts.get ( key )  ;^306^^^^^297^315^[REPLACE] return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return true;  ;^308^^^^^303^309^[REPLACE] return true;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return attrProts.containsKey ( key )  ;^306^^^^^297^315^[REPLACE] return !attrProts.containsKey ( key )  || testValidProtocol ( el, attr, attrProts.get ( key )  ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return true;  ;^308^^^^^297^315^[REPLACE] return true;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return !tagName.equals ( ":all" )  ;^312^^^^^297^315^[REPLACE] return !tagName.equals ( ":all" )  && isSafeAttribute ( ":all", el, attr ) ;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
[REPLACE]^return true;^314^^^^^297^315^[REPLACE] return false;^[METHOD] isSafeAttribute [TYPE] boolean [PARAMETER] String tagName Element el Attribute attr [CLASS] Whitelist TagName AttributeKey AttributeValue Protocol TypedValue   [TYPE]  AttributeKey key  [TYPE]  Set attributeSet  currentSet  protSet  tagNames  [TYPE]  boolean false  true  [TYPE]  TagName tag  [TYPE]  Attribute attr  [TYPE]  Element el  [TYPE]  String key  protocol  tag  tagName  value  [TYPE]  Map attrMap  attrProts  attributes  enforcedAttributes  protocols 
