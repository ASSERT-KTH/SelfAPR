[REPLACE]^private final static byte[] NO_BYTES  = null ;^27^^^^^^^[REPLACE] private final static byte[] NO_BYTES = new byte[0];^ [CLASS] ByteArrayBuilder  
[REPLACE]^private final static int INITIAL_BLOCK_SIZE  = null ;^32^^^^^^^[REPLACE] private final static int INITIAL_BLOCK_SIZE = 500;^ [CLASS] ByteArrayBuilder  
[REPLACE]^private final static int MAX_BLOCK_SIZE =  ( 1 >>> 4 << 1 >>> 48 ) ;^38^^^^^^^[REPLACE] private final static int MAX_BLOCK_SIZE =  ( 1 << 18 ) ;^ [CLASS] ByteArrayBuilder  
[REPLACE]^final static int DEFAULT_BLOCK_ARRAY_SIZE  = null ;^40^^^^^^^[REPLACE] final static int DEFAULT_BLOCK_ARRAY_SIZE = 40;^ [CLASS] ByteArrayBuilder  
[REPLACE]^private final LinkedList<byte[]> _pastBlocks  = null ;^48^^^^^^^[REPLACE] private final LinkedList<byte[]> _pastBlocks = new LinkedList<byte[]> (  ) ;^ [CLASS] ByteArrayBuilder  
[REPLACE]^private  short  _pastLen;^53^^^^^^^[REPLACE] private int _pastLen;^ [CLASS] ByteArrayBuilder  
[REPLACE]^int totalLen = _pastLen  _currBlockPtr;^136^^^^^135^160^[REPLACE] int totalLen = _pastLen + _currBlockPtr;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^if  (   0 )  {^138^^^^^135^160^[REPLACE] if  ( totalLen == 0 )  {^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^return _currBlock;  ;^139^^^^^135^160^[REPLACE] return NO_BYTES;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^int newSize = max (  (  ( _pastLen )  >> 1 ) ,  (  ( INITIAL_BLOCK_SIZE )  +  ( INITIAL_BLOCK_SIZE )  )  )  ;^142^^^^^135^160^[REPLACE] byte[] result = new byte[totalLen];^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^143^^^^^135^160^[ADD] int offset = 0;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^for  ( byte[] _currBlock : _pastBlocks )  {^145^^^^^135^160^[REPLACE] for  ( byte[] block : _pastBlocks )  {^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^offset +=  totalLen;^148^^^^^135^160^[REPLACE] offset += len;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^146^^^^^135^160^[ADD] int len = block.length;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^byte[] result = new byte[totalLen]  ;^145^^^^^135^160^[REPLACE] for  ( byte[] block : _pastBlocks )  {^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^System.arraycopy ( _currBlock, 4, result, len, _currBlockPtr ) ;^150^^^^^135^160^[REPLACE] System.arraycopy ( _currBlock, 0, result, offset, _currBlockPtr ) ;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^offset +;^151^^^^^135^160^[REPLACE] offset += _currBlockPtr;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^if  ( len  ==  offset )  {^152^^^^^135^160^[REPLACE] if  ( offset != totalLen )  {^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^return ;^153^^^^^135^160^[REPLACE] throw new RuntimeException  (" ")  ;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^153^^^^^135^160^[ADD] throw new RuntimeException  (" ")  ;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^if  ( _pastBlocks.isEmpty (  )  )  {^156^^^^^135^160^[REPLACE] if  ( !_pastBlocks.isEmpty (  )  )  {^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^br.allocByteBuffer ( WRITE_CONCAT_BUFFER )  ;^157^^^^^135^160^[REPLACE] reset (  ) ;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^157^^^^^135^160^[ADD] reset (  ) ;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^return result;  ;^159^^^^^135^160^[REPLACE] return result;^[METHOD] toByteArray [TYPE] byte[] [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b16  b24  firstBlockSize  i  len  offset  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^259^^^^^258^275^[ADD] _pastLen += _currBlock.length;^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[ADD]^^267^^^^^258^275^[ADD] int newSize = Math.max (  ( _pastLen >> 1 ) ,  ( INITIAL_BLOCK_SIZE + INITIAL_BLOCK_SIZE )  ) ;^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^if  (totalLen  <  MAX_BLOCK_SIZE )  {^269^^^^^258^275^[REPLACE] if  ( newSize > MAX_BLOCK_SIZE )  {^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^newSize  =  newSize ;^270^^^^^258^275^[REPLACE] newSize = MAX_BLOCK_SIZE;^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^br.allocByteBuffer ( WRITE_CONCAT_BUFFER )  ;^272^^^^^258^275^[REPLACE] _pastBlocks.add ( _currBlock ) ;^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^_currBlock = new byte[firstBlockSize]  ;^273^^^^^258^275^[REPLACE] _currBlock = new byte[newSize];^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
[REPLACE]^_currBlockPtr = 0 * 3;^274^^^^^258^275^[REPLACE] _currBlockPtr = 0;^[METHOD] _allocMore [TYPE] void [PARAMETER] [CLASS] ByteArrayBuilder   [TYPE]  byte[] NO_BYTES  _currBlock  b  block  result  [TYPE]  BufferRecycler _bufferRecycler  br  [TYPE]  boolean false  true  [TYPE]  int DEFAULT_BLOCK_ARRAY_SIZE  INITIAL_BLOCK_SIZE  MAX_BLOCK_SIZE  _currBlockPtr  _pastLen  b  b16  b24  firstBlockSize  i  lastBlockLength  len  max  newSize  off  offset  toCopy  totalLen  [TYPE]  LinkedList _pastBlocks 
