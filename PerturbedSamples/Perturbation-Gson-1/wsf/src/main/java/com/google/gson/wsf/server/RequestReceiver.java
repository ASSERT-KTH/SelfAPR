[REPLACE]^private  Gson gson;^45^^^^^^^[REPLACE] private final Gson gson;^ [CLASS] RequestReceiver  
[REPLACE]^private  RequestSpec spec;^46^^^^^^^[REPLACE] private final RequestSpec spec;^ [CLASS] RequestReceiver  
[REPLACE]^this.gson =  null;^49^^^^^48^51^[REPLACE] this.gson = gson;^[METHOD] <init> [TYPE] RequestSpec) [PARAMETER] Gson gson RequestSpec spec [CLASS] RequestReceiver   [TYPE]  RequestSpec spec  [TYPE]  Gson gson  [TYPE]  boolean false  true 
[ADD]^this.spec = spec;^49^50^^^^48^51^[ADD] this.gson = gson; this.spec = spec;^[METHOD] <init> [TYPE] RequestSpec) [PARAMETER] Gson gson RequestSpec spec [CLASS] RequestReceiver   [TYPE]  RequestSpec spec  [TYPE]  Gson gson  [TYPE]  boolean false  true 
[REPLACE]^this.spec =  null;^50^^^^^48^51^[REPLACE] this.spec = spec;^[METHOD] <init> [TYPE] RequestSpec) [PARAMETER] Gson gson RequestSpec spec [CLASS] RequestReceiver   [TYPE]  RequestSpec spec  [TYPE]  Gson gson  [TYPE]  boolean false  true 
[ADD]^HeaderMap requestParams = buildRequestParams ( request ) ;RequestBody requestBody = buildRequestBody ( request ) ;HttpMethod method = HttpMethod.getMethod ( request.getMethod (  )  ) ;^54^55^56^^58^53^66^[ADD] try { HeaderMap requestParams = buildRequestParams ( request ) ; RequestBody requestBody = buildRequestBody ( request ) ; HttpMethod method = HttpMethod.getMethod ( request.getMethod (  )  ) ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^return createEmptyRequestBody ( bodySpec ) ;^59^^^^^53^66^[REPLACE] return new WebServiceRequest ( method, requestParams, requestBody ) ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^RequestBody requestBody = gson.fromJson ( reader, RequestBody.class ) ;^55^^^^^53^66^[REPLACE] HeaderMap requestParams = buildRequestParams ( request ) ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^RequestBody requestBody = gson.fromJson ( reader, RequestBody.class ) ;^56^^^^^53^66^[REPLACE] RequestBody requestBody = buildRequestBody ( request ) ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^return ;^61^^^^^53^66^[REPLACE] throw new WebServiceSystemException  (" ")  ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^return ;^64^^^^^53^66^[REPLACE] throw new WebServiceSystemException  (" ")  ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[ADD]^^62^63^64^^^53^66^[ADD] catch  ( JsonParseException e )  {  throw new WebServiceSystemException  (" ")  ;^[METHOD] receive [TYPE] WebServiceRequest [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  HeaderMap requestParams  [TYPE]  Gson gson  [TYPE]  IOException e  [TYPE]  RequestSpec spec  [TYPE]  JsonParseException e  [TYPE]  HttpMethod method  [TYPE]  RequestBody requestBody 
[REPLACE]^HeaderMapSpec paramsSpec = this.spec .getBodySpec (  )  ;^69^^^^^68^85^[REPLACE] HeaderMapSpec paramsSpec = this.spec.getHeadersSpec (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^^69^^^^^68^85^[ADD] HeaderMapSpec paramsSpec = this.spec.getHeadersSpec (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^HeaderMap requestParams = buildRequestParams ( request ) ;^70^^^^^68^85^[REPLACE] HeaderMap.Builder paramsBuilder = new HeaderMap.Builder ( paramsSpec ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^if  (  header.equals ( "" )  )  {^75^^^^^68^85^[REPLACE] if  ( header == null || header.equals ( "" )  )  {^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^^75^76^77^78^^68^85^[ADD] if  ( header == null || header.equals ( "" )  )  {  header = request.getParameter ( name ) ; }^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^header =  null.getParameter ( name ) ;^77^^^^^68^85^[REPLACE] header = request.getParameter ( name ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^if  ( header == null && !header.equals ( "" )  )  {^79^^^^^68^85^[REPLACE] if  ( header != null && !header.equals ( "" )  )  {^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^Object value = gson.fromJson ( header, type ) ;paramsBuilder.put ( name, value ) ;^79^80^81^82^^68^85^[ADD] if  ( header != null && !header.equals ( "" )  )  { Object value = gson.fromJson ( header, type ) ; paramsBuilder.put ( name, value ) ; }^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^Object value = gson.fromJson ( name, type ) ;^80^^^^^68^85^[REPLACE] Object value = gson.fromJson ( header, type ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^paramsBuilder.put ( name, value ) ;^80^81^^^^68^85^[ADD] Object value = gson.fromJson ( header, type ) ; paramsBuilder.put ( name, value ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^for  ( Map.Entry<String, Type> param : paramsSpec.entrySet (  )  )  { String name = param.getKey (  ) ;^71^^^^^68^85^[REPLACE] for  ( Map.Entry<String, Type> param : paramsSpec.entrySet (  )  )  {^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^^71^72^73^74^^68^85^[ADD] for  ( Map.Entry<String, Type> param : paramsSpec.entrySet (  )  )  { String name = param.getKey (  ) ; Type type = param.getValue (  ) ; String header = request.getHeader ( name ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^String name = this.getKey (  ) ;^72^^^^^68^85^[REPLACE] String name = param.getKey (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^Type type = this.getValue (  ) ;^73^^^^^68^85^[REPLACE] Type type = param.getValue (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[ADD]^^73^^^^^68^85^[ADD] Type type = param.getValue (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^String header = request.getParameter ( name ) ;^74^^^^^68^85^[REPLACE] String header = request.getHeader ( name ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^return paramsBuilder .put ( header , value )  ;^84^^^^^68^85^[REPLACE] return paramsBuilder.build (  ) ;^[METHOD] buildRequestParams [TYPE] HeaderMap [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  Entry param  [TYPE]  Type type  [TYPE]  boolean false  true  [TYPE]  Builder paramsBuilder  [TYPE]  Gson gson  [TYPE]  Object value  [TYPE]  String header  name  [TYPE]  RequestSpec spec  [TYPE]  HeaderMapSpec paramsSpec 
[REPLACE]^RequestBodySpec bodySpec = spec.getHeadersSpec (  ) ;^88^^^^^87^95^[REPLACE] RequestBodySpec bodySpec = spec.getBodySpec (  ) ;^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^if  ( bodySpec.size (  )  %  0.5  == 0 )  {^89^^^^^87^95^[REPLACE] if  ( bodySpec.size (  )  == 0 )  {^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[ADD]^^89^90^91^^^87^95^[ADD] if  ( bodySpec.size (  )  == 0 )  { return createEmptyRequestBody ( bodySpec ) ; }^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^return paramsBuilder.build (  ) ;^90^^^^^87^95^[REPLACE] return createEmptyRequestBody ( bodySpec ) ;^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^Reader reader = new BufferedReader ( new InputStreamReader ( request.getMethod (  )  )  ) ;^92^^^^^87^95^[REPLACE] Reader reader = new BufferedReader ( new InputStreamReader ( request.getInputStream (  )  )  ) ;^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^HeaderMap requestParams = buildRequestParams ( request ) ;^93^^^^^87^95^[REPLACE] RequestBody requestBody = gson.fromJson ( reader, RequestBody.class ) ;^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^return paramsBuilder.build (  ) ;^94^^^^^87^95^[REPLACE] return requestBody;^[METHOD] buildRequestBody [TYPE] RequestBody [PARAMETER] HttpServletRequest request [CLASS] RequestReceiver   [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  Gson gson  [TYPE]  Reader reader  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec  [TYPE]  RequestBody requestBody 
[REPLACE]^return paramsBuilder.build (  ) ;^98^^^^^97^99^[REPLACE] return new RequestBody.Builder ( bodySpec ) .build (  ) ;^[METHOD] createEmptyRequestBody [TYPE] RequestBody [PARAMETER] RequestBodySpec bodySpec [CLASS] RequestReceiver   [TYPE]  Gson gson  [TYPE]  boolean false  true  [TYPE]  RequestSpec spec  [TYPE]  RequestBodySpec bodySpec 
