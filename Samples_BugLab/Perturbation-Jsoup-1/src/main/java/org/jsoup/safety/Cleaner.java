[BugLab_Variable_Misuse]^Validate.notNull ( clean ) ;^40^^^^^39^46^Validate.notNull ( dirtyDocument ) ;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Variable_Misuse]^Document clean = Document.createShell ( clean.baseUri (  )  ) ;^42^^^^^39^46^Document clean = Document.createShell ( dirtyDocument.baseUri (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Argument_Swapping]^copySafeNodes ( clean.body (  ) , dirtyDocument.body (  )  ) ;^43^^^^^39^46^copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Variable_Misuse]^copySafeNodes ( clean.body (  ) , clean.body (  )  ) ;^43^^^^^39^46^copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Variable_Misuse]^copySafeNodes ( dirtyDocument.body (  ) , dirtyDocument.body (  )  ) ;^43^^^^^39^46^copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Variable_Misuse]^return dirtyDocument;^45^^^^^39^46^return clean;^[CLASS] Cleaner ElementMeta  [METHOD] clean [RETURN_TYPE] Document   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  Element  el  
[BugLab_Variable_Misuse]^Validate.notNull ( clean ) ;^59^^^^^58^64^Validate.notNull ( dirtyDocument ) ;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Variable_Misuse]^Document clean = Document.createShell ( clean.baseUri (  )  ) ;^61^^^^^58^64^Document clean = Document.createShell ( dirtyDocument.baseUri (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Variable_Misuse]^int numDiscarded = copySafeNodes ( clean.body (  ) , clean.body (  )  ) ;^62^^^^^58^64^int numDiscarded = copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Variable_Misuse]^int numDiscarded = copySafeNodes ( dirtyDocument.body (  ) , dirtyDocument.body (  )  ) ;^62^^^^^58^64^int numDiscarded = copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Argument_Swapping]^int numDiscarded = copySafeNodes ( clean.body (  ) , dirtyDocument.body (  )  ) ;^62^^^^^58^64^int numDiscarded = copySafeNodes ( dirtyDocument.body (  ) , clean.body (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Variable_Misuse]^return numAttribsDiscarded == 0;^63^^^^^58^64^return numDiscarded == 0;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Wrong_Operator]^return numDiscarded != 0;^63^^^^^58^64^return numDiscarded == 0;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Wrong_Literal]^return numDiscarded == -1;^63^^^^^58^64^return numDiscarded == 0;^[CLASS] Cleaner ElementMeta  [METHOD] isValid [RETURN_TYPE] boolean   Document dirtyDocument [VARIABLES] Whitelist  whitelist  boolean  Document  clean  dirtyDocument  int  numAttribsDiscarded  numDiscarded  Element  el  
[BugLab_Variable_Misuse]^List<Node> sourceElChildren = source.childNodes (  ) ;^73^^^^^72^98^List<Node> sourceChildren = source.childNodes (  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Literal]^int numDiscarded = ;^74^^^^^72^98^int numDiscarded = 0;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Operator]^if  ( sourceChild  >=  Element )  {^77^^^^^72^98^if  ( sourceChild instanceof Element )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Operator]^if  ( sourceChild  ==  Element )  {^77^^^^^72^98^if  ( sourceChild instanceof Element )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Operator]^} else if  ( sourceChild  <<  TextNode )  {^91^^^^^72^98^} else if  ( sourceChild instanceof TextNode )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^TextNode destText = new TextNode ( sourceChild.getWholeText (  ) , sourceText.baseUri (  )  ) ;^93^^^^^72^98^TextNode destText = new TextNode ( sourceText.getWholeText (  ) , sourceChild.baseUri (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^TextNode destText = new TextNode ( destText.getWholeText (  ) , sourceChild.baseUri (  )  ) ;^93^^^^^72^98^TextNode destText = new TextNode ( sourceText.getWholeText (  ) , sourceChild.baseUri (  )  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^dest.appendChild ( sourceElText ) ;^94^^^^^72^98^dest.appendChild ( destText ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^dest.appendChild ( sourceText ) ;^94^^^^^72^98^dest.appendChild ( destText ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^dest.appendChild ( destTextText ) ;^94^^^^^72^98^dest.appendChild ( destText ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^dest.appendChild ( dest ) ;^94^^^^^72^98^dest.appendChild ( destText ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^if  ( whitelist.isSafeTag ( el.tagName (  )  )  )  {^80^^^^^72^98^if  ( whitelist.isSafeTag ( sourceEl.tagName (  )  )  )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( source, dest ) ;^89^^^^^80^90^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( sourceEl, source ) ;^89^^^^^80^90^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^numDiscarded += copySafeNodes ( dest, sourceEl ) ;^89^^^^^80^90^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^numDiscarded += meta.numAttribsDiscarded.numAttribsDiscarded;^85^^^^^72^98^numDiscarded += meta.numAttribsDiscarded;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^numDiscarded += meta;^85^^^^^72^98^numDiscarded += meta.numAttribsDiscarded;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( source, destChild ) ;^86^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( sourceEl, source ) ;^86^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^numDiscarded += copySafeNodes ( destChild, sourceEl ) ;^86^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^ElementMeta meta = createSafeElement ( source ) ;^81^^^^^72^98^ElementMeta meta = createSafeElement ( sourceEl ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Element destChild = meta.el.el;^82^^^^^72^98^Element destChild = meta.el;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Element destChild = meta;^82^^^^^72^98^Element destChild = meta.el;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^dest.appendChild ( sourceElChild ) ;^83^^^^^72^98^dest.appendChild ( destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^dest.appendChild ( sourceEl ) ;^83^^^^^72^98^dest.appendChild ( destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^dest.appendChild ( destChildChild ) ;^83^^^^^72^98^dest.appendChild ( destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^dest.appendChild ( dest ) ;^83^^^^^72^98^dest.appendChild ( destChild ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += numDiscarded;^85^^^^^72^98^numDiscarded += meta.numAttribsDiscarded;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( source, dest ) ;^89^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^numDiscarded += copySafeNodes ( sourceEl, source ) ;^89^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^numDiscarded += copySafeNodes ( dest, sourceEl ) ;^89^^^^^72^98^numDiscarded += copySafeNodes ( sourceEl, dest ) ;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^Element destChild = sourceEl;^82^^^^^72^98^Element destChild = meta.el;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^if  ( whitelist.isSafeTag ( source.tagName (  )  )  )  {^80^^^^^72^98^if  ( whitelist.isSafeTag ( sourceEl.tagName (  )  )  )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( sourceEl.isSafeTag ( whitelist.tagName (  )  )  )  {^80^^^^^72^98^if  ( whitelist.isSafeTag ( sourceEl.tagName (  )  )  )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Operator]^} else if  ( sourceChild  ==  TextNode )  {^91^^^^^72^98^} else if  ( sourceChild instanceof TextNode )  {^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^return numAttribsDiscarded;^97^^^^^72^98^return numDiscarded;^[CLASS] Cleaner ElementMeta  [METHOD] copySafeNodes [RETURN_TYPE] int   Element source Element dest [VARIABLES] ElementMeta  meta  boolean  Element  dest  destChild  el  source  sourceEl  Node  sourceChild  Whitelist  whitelist  List  sourceChildren  TextNode  destText  sourceText  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^String sourceTag = source.tagName (  ) ;^101^^^^^100^117^String sourceTag = sourceEl.tagName (  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^Element dest = new Element ( Tag.valueOf ( sourceTag ) , source.baseUri (  ) , destAttrs ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , sourceAttrs ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Element dest = new Element ( Tag.valueOf ( sourceEl ) , sourceTag.baseUri (  ) , destAttrs ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Element dest = new Element ( Tag.valueOf ( sourceTag ) , destAttrs.baseUri (  ) , sourceEl ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Element dest = new Element ( Tag.valueOf ( destAttrs ) , sourceEl.baseUri (  ) , sourceTag ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^Element dest = new Element ( Tag.valueOf ( sourceTag ) , el.baseUri (  ) , destAttrs ) ;^103^^^^^100^117^Element dest = new Element ( Tag.valueOf ( sourceTag ) , sourceEl.baseUri (  ) , destAttrs ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Wrong_Literal]^int numDiscarded = -1;^104^^^^^100^117^int numDiscarded = 0;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^Attributes sourceAttrs = source.attributes (  ) ;^106^^^^^100^117^Attributes sourceAttrs = sourceEl.attributes (  ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^if  ( whitelist.isSafeAttribute ( sourceTag, source, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( whitelist.isSafeAttribute ( sourceEl, sourceTag, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( whitelist.isSafeAttribute ( sourceTag, sourceAttr, sourceEl )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( whitelist.isSafeAttribute ( sourceAttr, sourceEl, sourceTag )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( whitelist.isSafeAttribute ( sourceTag, destAttrs, sourceAttr )  ) sourceEl.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( sourceAttr.isSafeAttribute ( sourceTag, sourceEl, whitelist )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^if  ( whitelist.isSafeAttribute ( sourceTag, el, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^if  ( sourceEl.isSafeAttribute ( sourceTag, whitelist, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^108^109^^^^100^117^if  ( whitelist.isSafeAttribute ( sourceTag, sourceEl, sourceAttr )  ) destAttrs.put ( sourceAttr ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^Attributes enforcedAttrs = sourceTag.getEnforcedAttributes ( whitelist ) ;^113^^^^^100^117^Attributes enforcedAttrs = whitelist.getEnforcedAttributes ( sourceTag ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^return new ElementMeta ( sourceEl, numDiscarded ) ;^116^^^^^100^117^return new ElementMeta ( dest, numDiscarded ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Variable_Misuse]^return new ElementMeta ( dest, numAttribsDiscarded ) ;^116^^^^^100^117^return new ElementMeta ( dest, numDiscarded ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
[BugLab_Argument_Swapping]^return new ElementMeta ( numDiscarded, dest ) ;^116^^^^^100^117^return new ElementMeta ( dest, numDiscarded ) ;^[CLASS] Cleaner ElementMeta  [METHOD] createSafeElement [RETURN_TYPE] Cleaner$ElementMeta   Element sourceEl [VARIABLES] boolean  Attribute  sourceAttr  Element  dest  destChild  el  source  sourceEl  Attributes  destAttrs  enforcedAttrs  sourceAttrs  Whitelist  whitelist  String  sourceTag  int  numAttribsDiscarded  numDiscarded  
