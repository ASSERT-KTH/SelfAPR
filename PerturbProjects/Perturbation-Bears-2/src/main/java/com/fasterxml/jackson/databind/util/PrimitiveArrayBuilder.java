[REPLACE]^final static int INITIAL_CHUNK_SIZE ;^11^^^^^^^[REPLACE] final static int INITIAL_CHUNK_SIZE = 12;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^final  int SMALL_CHUNK_SIZE =  ( 1 << 14 ) ;^17^^^^^^^[REPLACE] final static int SMALL_CHUNK_SIZE =  ( 1 << 14 ) ;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^final static int MAX_CHUNK_SIZE  = null ;^25^^^^^^^[REPLACE] final static int MAX_CHUNK_SIZE =  ( 1 << 18 ) ;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^private T _freeBuffer;^29^^^^^^^[REPLACE] protected T _freeBuffer;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^protected Object _bufferHead;^31^^^^^^^[REPLACE] protected Node<T> _bufferHead;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^protected Object _bufferTail;^33^^^^^^^[REPLACE] protected Node<T> _bufferTail;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^private int _bufferedEntryCount;^39^^^^^^^[REPLACE] protected int _bufferedEntryCount;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^Object _data;^148^^^^^^^[REPLACE] final T _data;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^final  long  _dataLength;^153^^^^^^^[REPLACE] final int _dataLength;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^Object _next;^155^^^^^^^[REPLACE] Node<T> _next;^ [CLASS] PrimitiveArrayBuilder Node  
[REPLACE]^Node<T> next = new Node<T> ( _freeBuffer, fullChunkLength ) ;^67^^^^^66^83^[REPLACE] Node<T> next = new Node<T> ( fullChunk, fullChunkLength ) ;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^if  ( _bufferHead != null )  {^68^^^^^66^83^[REPLACE] if  ( _bufferHead == null )  {^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^_bufferTail = null  ;^72^^^^^68^73^[REPLACE] _bufferTail = next;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^_bufferHead = _bufferTail = null  ;^69^^^^^66^83^[REPLACE] _bufferHead = _bufferTail = next;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^_bufferTail = null  ;^69^^^^^66^83^[REPLACE] _bufferHead = _bufferTail = next;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^_bufferTail = null  ;^72^^^^^66^83^[REPLACE] _bufferTail = next;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^_bufferedEntryCount +=  nextLen;^74^^^^^66^83^[REPLACE] _bufferedEntryCount += fullChunkLength;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^int nextLen = nextLen;^75^^^^^66^83^[REPLACE] int nextLen = fullChunkLength;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^if  (fullChunkLength  <=  SMALL_CHUNK_SIZE )  {^77^^^^^66^83^[REPLACE] if  ( nextLen < SMALL_CHUNK_SIZE )  {^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^nextLen +=  (_dataLength  >=  2 ) ;^80^^^^^77^81^[REPLACE] nextLen +=  ( nextLen >> 2 ) ;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^nextLen += nextLen >> 2  ;^78^^^^^66^83^[REPLACE] nextLen += nextLen;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^nextLen +=  ( nextLen  >=  2 ) ;^80^^^^^66^83^[REPLACE] nextLen +=  ( nextLen >> 2 ) ;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[REPLACE]^return _constructArray ( fullChunkLength ) ;^82^^^^^66^83^[REPLACE] return _constructArray ( nextLen ) ;^[METHOD] appendCompletedChunk [TYPE] T [PARAMETER] T fullChunk int fullChunkLength [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  nextLen  [TYPE]  Node _bufferHead  _bufferTail  _next  next 
[ADD]^^87^88^^^^86^103^[ADD] int totalSize = lastChunkEntries + _bufferedEntryCount; T resultArray = _constructArray ( totalSize ) ;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^T resultArray = _constructArray ( ptr ) ;^88^^^^^86^103^[REPLACE] T resultArray = _constructArray ( totalSize ) ;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^int ptr = 0L;^90^^^^^86^103^[REPLACE] int ptr = 0;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^for  ( Node<T> n =  _bufferHead; null !^92^^^^^86^103^[REPLACE] for  ( Node<T> n = _bufferHead; n != null; n = n.next (  )  )  {^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^ptr =  null.copyData ( resultArray, ptr ) ;^93^^^^^86^103^[REPLACE] ptr = n.copyData ( resultArray, ptr ) ;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^System.arraycopy ( lastChunk, 0 - 0, resultArray, ptr, lastChunkEntries ) ;^95^^^^^86^103^[REPLACE] System.arraycopy ( lastChunk, 0, resultArray, ptr, lastChunkEntries ) ;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^ptr +=  null;^96^^^^^86^103^[REPLACE] ptr += lastChunkEntries;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^if  (nextLen  ==  totalSize )  {^99^^^^^86^103^[REPLACE] if  ( ptr != totalSize )  {^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^return ;^100^^^^^86^103^[REPLACE] throw new IllegalStateException  (" ")  ;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^return lastChunk;^102^^^^^86^103^[REPLACE] return resultArray;^[METHOD] completeAndClearBuffer [TYPE] T [PARAMETER] T lastChunk int lastChunkEntries [CLASS] PrimitiveArrayBuilder Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
[REPLACE]^final PrimitiveArrayBuilder$Node _data;^148^^^^^^^[REPLACE] final T _data;^[METHOD] linkNext [TYPE] void [PARAMETER] Node<T> next [CLASS] Node   [TYPE]  boolean false  true  [TYPE]  T _data  _freeBuffer  data  dst  fullChunk  lastChunk  resultArray  [TYPE]  int INITIAL_CHUNK_SIZE  MAX_CHUNK_SIZE  SMALL_CHUNK_SIZE  _bufferedEntryCount  _dataLength  dataLen  fullChunkLength  lastChunkEntries  len  nextLen  ptr  totalSize  [TYPE]  Node _bufferHead  _bufferTail  _next  n  next 
