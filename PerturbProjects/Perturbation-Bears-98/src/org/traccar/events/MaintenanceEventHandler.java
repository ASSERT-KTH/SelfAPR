[REPLACE]^public static final String ATTRIBUTE_MAINTENANCE_START ;^30^^^^^^^[REPLACE] public static final String ATTRIBUTE_MAINTENANCE_START = "maintenance.start";^ [CLASS] MaintenanceEventHandler  
[REPLACE]^public static final String ATTRIBUTE_MAINTENANCE_INTERVAL ;^31^^^^^^^[REPLACE] public static final String ATTRIBUTE_MAINTENANCE_INTERVAL = "maintenance.interval";^ [CLASS] MaintenanceEventHandler  
[REPLACE]^Device device = Context.getIdentityManager (  ) .isLatestPosition ( lastPosition.getDeviceId (  )  ) ;^35^^^^^34^67^[REPLACE] Device device = Context.getIdentityManager (  ) .getDeviceById ( position.getDeviceId (  )  ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^if  ( device != null || !Context.getDeviceManager (  ) .isLatestPosition ( position )  )  {^36^^^^^34^67^[REPLACE] if  ( device == null || !Context.getIdentityManager (  ) .isLatestPosition ( position )  )  {^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^return false;^37^^^^^34^67^[REPLACE] return null;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^double maintenanceInterval = Context.getDeviceManager (  ) .lookupAttributeDouble ( device.getId (  ) , ATTRIBUTE_MAINTENANCE_INTERVAL, 0L, false ) ;^40^41^^^^34^67^[REPLACE] double maintenanceInterval = Context.getDeviceManager (  ) .lookupAttributeDouble ( device.getId (  ) , ATTRIBUTE_MAINTENANCE_INTERVAL, 0, false ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^if  (oldTotalDistance  !=  0 )  {^42^^^^^34^67^[REPLACE] if  ( maintenanceInterval == 0 )  {^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^return false;^43^^^^^34^67^[REPLACE] return null;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[ADD]^^45^46^^^^34^67^[ADD] double maintenanceStart = Context.getDeviceManager (  ) .lookupAttributeDouble ( device.getId (  ) , ATTRIBUTE_MAINTENANCE_START, 0, false ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^double oldTotalDistance = 0.0D;^48^^^^^34^67^[REPLACE] double oldTotalDistance = 0.0;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^double newTotalDistance = 0.0D;^49^^^^^34^67^[REPLACE] double newTotalDistance = 0.0;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^Position lastPosition = Context.getIdentityManager (  ) .isLatestPosition ( lastPosition.getDeviceId (  )  ) ;^51^^^^^34^67^[REPLACE] Position lastPosition = Context.getIdentityManager (  ) .getLastPosition ( position.getDeviceId (  )  ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^if  ( lastPosition == this  )  {^52^^^^^34^67^[REPLACE] if  ( lastPosition != null )  {^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^newTotalDistance = position.getDouble ( Position.KEY_TOTAL_DISTANCE )  ;^53^^^^^34^67^[REPLACE] oldTotalDistance = lastPosition.getDouble ( Position.KEY_TOTAL_DISTANCE ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[ADD]^^53^^^^^34^67^[ADD] oldTotalDistance = lastPosition.getDouble ( Position.KEY_TOTAL_DISTANCE ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^oldTotalDistance = lastPosition.getDouble ( Position.KEY_TOTAL_DISTANCE )  ;^55^^^^^34^67^[REPLACE] newTotalDistance = position.getDouble ( Position.KEY_TOTAL_DISTANCE ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[ADD]^^57^^^^^34^67^[ADD] oldTotalDistance -= maintenanceStart;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^oldTotalDistance -= maintenanceStart  ;^58^^^^^34^67^[REPLACE] newTotalDistance -= maintenanceStart;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^if  (  ( long )   ( oldTotalDistance / maintenanceInterval )   >=   ( long )   ( newTotalDistance / maintenanceInterval )  )  {^60^^^^^34^67^[REPLACE] if  (  ( long )   ( oldTotalDistance / maintenanceInterval )  <  ( long )   ( newTotalDistance / maintenanceInterval )  )  {^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[ADD]^Event event = new Event ( Event.TYPE_MAINTENANCE, position.getDeviceId (  ) , position.getId (  )  ) ;event.set ( Position.KEY_TOTAL_DISTANCE, newTotalDistance ) ;return Collections.singleton ( event ) ;^60^61^62^63^64^34^67^[ADD] if  (  ( long )   ( oldTotalDistance / maintenanceInterval )  <  ( long )   ( newTotalDistance / maintenanceInterval )  )  { Event event = new Event ( Event.TYPE_MAINTENANCE, position.getDeviceId (  ) , position.getId (  )  ) ; event.set ( Position.KEY_TOTAL_DISTANCE, newTotalDistance ) ; return Collections.singleton ( event ) ; }^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^Event event = new Event ( Event.TYPE_MAINTENANCE, lastPosition.getDeviceId (  ) , position.getDeviceId (  )  ) ;^61^^^^^34^67^[REPLACE] Event event = new Event ( Event.TYPE_MAINTENANCE, position.getDeviceId (  ) , position.getId (  )  ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[ADD]^^61^62^^^^34^67^[ADD] Event event = new Event ( Event.TYPE_MAINTENANCE, position.getDeviceId (  ) , position.getId (  )  ) ; event.set ( Position.KEY_TOTAL_DISTANCE, newTotalDistance ) ;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
[REPLACE]^return this;^66^^^^^34^67^[REPLACE] return null;^[METHOD] analyzePosition [TYPE] Collection [PARAMETER] Position position [CLASS] MaintenanceEventHandler   [TYPE]  Event event  [TYPE]  String ATTRIBUTE_MAINTENANCE_INTERVAL  ATTRIBUTE_MAINTENANCE_START  [TYPE]  boolean false  true  [TYPE]  Position lastPosition  position  [TYPE]  Device device  [TYPE]  double maintenanceInterval  maintenanceStart  newTotalDistance  oldTotalDistance 
