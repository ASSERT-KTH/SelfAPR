[REPLACE]^private static final  long  BLOCK_LENGTH = 16;^37^^^^^^^[REPLACE] private static final int BLOCK_LENGTH = 16;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^public static final int MSG_ACKNOWLEDGEMENT  = null ;^43^^^^^^^[REPLACE] public static final int MSG_ACKNOWLEDGEMENT = 0x00;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^public static final int MSG_DEVICE_ID  = null ;^44^^^^^^^[REPLACE] public static final int MSG_DEVICE_ID = 0x01;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^public static final int MSG_TRACK_REQUEST ;^45^^^^^^^[REPLACE] public static final int MSG_TRACK_REQUEST = 0x88;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^public static final int MSG_TRACK_RESPONSE ;^46^^^^^^^[REPLACE] public static final int MSG_TRACK_RESPONSE = 0x89;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^public static final int MSG_SESSION_END ;^47^^^^^^^[REPLACE] public static final int MSG_SESSION_END = 0x0c;^ [CLASS] At2000ProtocolDecoder  
[REPLACE]^if  ( buf.getUnsignedByte ( buf.readerIndex (  )  )   ||  0x01L )  {^78^^^^^74^146^[REPLACE] if  ( buf.getUnsignedByte ( buf.readerIndex (  )  )  == 0x01 )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^buf.readUnsignedByte (  ) ;^78^79^80^^^74^146^[ADD] if  ( buf.getUnsignedByte ( buf.readerIndex (  )  )  == 0x01 )  { buf.readUnsignedByte (  ) ; }^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^buf .getUnsignedByte (  )  ;^79^^^^^74^146^[REPLACE] buf.readUnsignedByte (  ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^int type = buf.getUnsignedByte (  ) ;^82^^^^^74^146^[REPLACE] int type = buf.readUnsignedByte (  ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^buf .readUnsignedByte (  )  ;^83^^^^^74^146^[REPLACE] buf.readUnsignedMedium (  ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^buf.skipBytes ( BLOCK_LENGTH  2 type ) ;^84^^^^^74^146^[REPLACE] buf.skipBytes ( BLOCK_LENGTH - 1 - 3 ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REMOVE]^response.writerIndex ( BLOCK_LENGTH )  ;^84^^^^^74^146^[REMOVE] ^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  ( type  &&  MSG_DEVICE_ID )  {^86^^^^^74^146^[REPLACE] if  ( type == MSG_DEVICE_ID )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^}  else {^107^^^^^74^146^[REPLACE] } else if  ( type == MSG_TRACK_RESPONSE )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  ( deviceSession != false )  {^110^^^^^74^146^[REPLACE] if  ( deviceSession == null )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^return null;^110^111^112^^^74^146^[ADD] if  ( deviceSession == null )  { return null; }^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^return true;^111^^^^^74^146^[REPLACE] return null;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^120^^^^^74^146^[ADD] buf = ChannelBuffers.wrappedBuffer ( ByteOrder.LITTLE_ENDIAN, cipher.update ( data )  ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^return this;^111^^^^^74^146^[REPLACE] return null;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^109^^^^^74^146^[ADD] DeviceSession deviceSession = getDeviceSession ( channel, remoteAddress ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^byte[] data = new byte[buf.capacity (  )   BLOCK_LENGTH];^118^^^^^74^146^[REPLACE] byte[] data = new byte[buf.capacity (  )  - BLOCK_LENGTH];^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  ( deviceSession != null )  {^110^^^^^74^146^[REPLACE] if  ( deviceSession == null )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^buf =  ChannelBuffers.wrappedBuffer ( ByteOrder.LITTLE_ENDIAN, cipher.update ( null )  ) ;^120^^^^^74^146^[REPLACE] buf = ChannelBuffers.wrappedBuffer ( ByteOrder.LITTLE_ENDIAN, cipher.update ( data )  ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^return false;^111^^^^^74^146^[REPLACE] return null;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^118^119^^^^74^146^[ADD] byte[] data = new byte[buf.capacity (  )  - BLOCK_LENGTH]; buf.readBytes ( data ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  ( getDeviceSession ( channel, remoteAddress, imei )  == null )  {^89^^^^^74^146^[REPLACE] if  ( getDeviceSession ( channel, remoteAddress, imei )  != null )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^89^90^91^92^93^74^146^[ADD] if  ( getDeviceSession ( channel, remoteAddress, imei )  != null )  {  byte[] iv = new byte[BLOCK_LENGTH]; buf.readBytes ( iv ) ; IvParameterSpec ivSpec = new IvParameterSpec ( iv ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^cipher  =  cipher ;^98^^^^^74^146^[REPLACE] cipher = Cipher.getInstance ( "AES/CBC/NoPadding" ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^91^^^^^74^146^[ADD] byte[] iv = new byte[BLOCK_LENGTH];^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^93^^^^^74^146^[ADD] IvParameterSpec ivSpec = new IvParameterSpec ( iv ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^byte[] iv = new BLOCK_LENGTH]  ;^101^^^^^74^146^[REPLACE] byte[] data = new byte[BLOCK_LENGTH];^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^cipher ;^98^^^^^74^146^[REPLACE] cipher = Cipher.getInstance ( "AES/CBC/NoPadding" ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^String imei = buf.readBytes ( 4 ) .toString ( StandardCharsets.US_ASCII ) ;^88^^^^^74^146^[REPLACE] String imei = buf.readBytes ( 15 ) .toString ( StandardCharsets.US_ASCII ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^byte[] data = new BLOCK_LENGTH]  ;^91^^^^^74^146^[REPLACE] byte[] iv = new byte[BLOCK_LENGTH];^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  ( getDeviceSession ( channel, remoteAddress, imei )  == false )  {^89^^^^^74^146^[REPLACE] if  ( getDeviceSession ( channel, remoteAddress, imei )  != null )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^98^^^^^74^146^[ADD] cipher = Cipher.getInstance ( "AES/CBC/NoPadding" ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^110^111^112^^^74^146^[ADD] if  ( deviceSession == null )  { return null; }^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^88^^^^^74^146^[ADD] String imei = buf.readBytes ( 15 ) .toString ( StandardCharsets.US_ASCII ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^^95^96^^^^74^146^[ADD] SecretKeySpec keySpec = new SecretKeySpec ( DatatypeConverter.parseHexBinary ( "000102030405060708090a0b0c0d0e0f" ) , "AES" ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^byte[] data = new BLOCK_LENGTH]  ;^118^^^^^74^146^[REPLACE] byte[] data = new byte[buf.capacity (  )  - BLOCK_LENGTH];^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^sendRequest ( channel )  ;^139^^^^^74^146^[REPLACE] sendResponse ( channel ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^if  (   MSG_DEVICE_ID )  {^141^^^^^74^146^[REPLACE] if  ( type == MSG_DEVICE_ID )  {^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[ADD]^sendRequest ( channel ) ;^141^142^143^^^74^146^[ADD] if  ( type == MSG_DEVICE_ID )  { sendRequest ( channel ) ; }^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^sendResponse ( channel )  ;^142^^^^^74^146^[REPLACE] sendRequest ( channel ) ;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
[REPLACE]^return false;^145^^^^^74^146^[REPLACE] return null;^[METHOD] decode [TYPE] Object [PARAMETER] Channel channel SocketAddress remoteAddress Object msg [CLASS] At2000ProtocolDecoder   [TYPE]  DeviceSession deviceSession  [TYPE]  Position position  [TYPE]  Channel channel  [TYPE]  String imei  [TYPE]  int BLOCK_LENGTH  MSG_ACKNOWLEDGEMENT  MSG_DEVICE_ID  MSG_SESSION_END  MSG_TRACK_REQUEST  MSG_TRACK_RESPONSE  type  [TYPE]  ChannelBuffer buf  [TYPE]  byte[] data  iv  [TYPE]  boolean false  true  [TYPE]  SecretKeySpec keySpec  [TYPE]  Object msg  [TYPE]  IvParameterSpec ivSpec  [TYPE]  Cipher cipher  [TYPE]  SocketAddress remoteAddress 
