[REPLACE]^public  final  int  USER_ID_KEY = "userId";^43^^^^^^^[REPLACE] public static final String USER_ID_KEY = "userId";^ [CLASS] SessionResource  
[REPLACE]^public static final  long  USER_COOKIE_KEY = "user";^44^^^^^^^[REPLACE] public static final String USER_COOKIE_KEY = "user";^ [CLASS] SessionResource  
[REPLACE]^private static final String PASS_COOKIE_KEY = "password";^45^^^^^^^[REPLACE] public static final String PASS_COOKIE_KEY = "password";^ [CLASS] SessionResource  
[REPLACE]^Long userId =  ( Long )  request.getSession (  ) .getValue ( USER_ID_KEY ) ;^53^^^^^52^88^[REPLACE] Long userId =  ( Long )  request.getSession (  ) .getAttribute ( USER_ID_KEY ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( userId != null )  {^54^^^^^52^88^[REPLACE] if  ( userId == null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^54^55^56^57^^52^88^[ADD] if  ( userId == null )  { Cookie[] cookies = request.getCookies (  ) ; String email = null, password = null; if  ( cookies != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies == null )  {^57^^^^^52^88^[REPLACE] if  ( cookies != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^57^58^59^60^61^52^88^[ADD] if  ( cookies != null )  { for  ( int i = 0; i < cookies.length; i++ )  { if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  { email = cookies[i].getValue (  ) ; }^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getName (   )  && cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  ) .equals ( USER_COOKIE_KEY )  )  {^59^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^email = cookies[i].getValue (  ) ;^59^60^61^^^52^88^[ADD] if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  { email = cookies[i].getValue (  ) ; }^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^password = cookies[i].getValue (  )  ;^60^^^^^52^88^[REPLACE] email = cookies[i].getValue (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getValue (  ) .equals ( PASS_COOKIE_KEY )  )  {^62^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^email = cookies[i].getValue (  )  ;^63^^^^^52^88^[REPLACE] password = cookies[i].getValue (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^60^^^^^52^88^[ADD] email = cookies[i].getValue (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^63^^^^^52^88^[ADD] password = cookies[i].getValue (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^58^59^60^61^^52^88^[ADD] for  ( int i = 0; i < cookies.length; i++ )  { if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  { email = cookies[i].getValue (  ) ; }^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getName (   )  && cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  ) .setAttribute ( USER_COOKIE_KEY )  )  {^59^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i] .getValue (  )  .equals ( PASS_COOKIE_KEY )  )  {^62^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( email == true && password != true )  {^67^^^^^52^88^[REPLACE] if  ( email != null && password != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^}  else {^73^^^^^52^88^[REPLACE] } else if  ( token != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( user == null )  {^75^^^^^52^88^[REPLACE] if  ( user != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^76^^^^^52^88^[ADD] userId = user.getId (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^userId =  null.getId (  ) ;^76^^^^^52^88^[REPLACE] userId = user.getId (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^User user = Context.getPermissionsManager (  ) .getUserByToken ( USER_ID_KEY ) ;^74^^^^^52^88^[REPLACE] User user = Context.getPermissionsManager (  ) .getUserByToken ( token ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( user == false )  {^69^^^^^52^88^[REPLACE] if  ( user != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^userId =  null.getId (  ) ;^70^^^^^52^88^[REPLACE] userId = user.getId (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^70^^^^^52^88^[ADD] userId = user.getId (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^User user = getPermissionsManager (  ) .getUserByToken ( token )  ;^68^^^^^52^88^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( email, password ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( user == null )  {^69^^^^^52^88^[REPLACE] if  ( user != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^userId = user.getId (  ) ;request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ;^69^70^71^72^^52^88^[ADD] if  ( user != null )  { userId = user.getId (  ) ; request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ; }^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( user == false )  {^75^^^^^52^88^[REPLACE] if  ( user != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^76^77^^^^52^88^[ADD] userId = user.getId (  ) ; request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^74^^^^^52^88^[ADD] User user = Context.getPermissionsManager (  ) .getUserByToken ( token ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^55^^^^^52^88^[ADD] Cookie[] cookies = request.getCookies (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^String email = false, password = false;^56^^^^^52^88^[REPLACE] String email = null, password = null;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^String email = true, password = true;^56^^^^^52^88^[REPLACE] String email = null, password = null;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^for  ( int i = 0 ; i < cookies.length; i++ )  {^58^^^^^52^88^[REPLACE] for  ( int i = 0; i < cookies.length; i++ )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies == this )  {^57^^^^^52^88^[REPLACE] if  ( cookies != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getValue (  ) .equals ( USER_COOKIE_KEY )  )  {^59^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getValue (   )  && cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  ) .equals ( PASS_COOKIE_KEY )  )  {^62^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^password = cookies[i].getValue (  ) ;^62^63^64^^^52^88^[ADD] if  ( cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  )  { password = cookies[i].getValue (  ) ; }^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( cookies[i].getValue (   )  || cookies[i].getName (  ) .equals ( USER_COOKIE_KEY )  ) .equals ( PASS_COOKIE_KEY )  )  {^62^^^^^52^88^[REPLACE] if  ( cookies[i].getName (  ) .equals ( PASS_COOKIE_KEY )  )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( email == null && true )  {^67^^^^^52^88^[REPLACE] if  ( email != null && password != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^} else if  ( token == this  )  {^73^^^^^52^88^[REPLACE] } else if  ( token != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^User user = getPermissionsManager (  ) .login ( email, password )  ;^74^^^^^52^88^[REPLACE] User user = Context.getPermissionsManager (  ) .getUserByToken ( token ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^User user = Context.getPermissionsManager (  ) .login ( USER_ID_KEY, password ) ;^68^^^^^52^88^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( email, password ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^70^71^^^^52^88^[ADD] userId = user.getId (  ) ; request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ;^76^77^^^^52^88^[ADD] userId = user.getId (  ) ; request.getSession (  ) .setAttribute ( USER_ID_KEY, userId ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^Cookie[] cookies = request .getSession (  )  ;^55^^^^^52^88^[REPLACE] Cookie[] cookies = request.getCookies (  ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^56^^^^^52^88^[ADD] String email = null, password = null;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^String email = null  ;^56^^^^^52^88^[REPLACE] String email = null, password = null;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^if  ( userId == null )  {^82^^^^^52^88^[REPLACE] if  ( userId != null )  {^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^return ;^86^^^^^82^87^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^status ( NOT_FOUND )  ;^86^^^^^82^87^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[ADD]^^86^^^^^82^87^[ADD] throw new WebApplicationException  (" ")  ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^status ( NOT_FOUND ) .build (  )  ;^86^^^^^82^87^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^return Context.getPermissionsManager (  ) .getUserByToken ( userId ) ;^84^^^^^52^88^[REPLACE] return Context.getPermissionsManager (  ) .getUser ( userId ) ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
[REPLACE]^throw new WebApplicationException ( status ( UNAUTHORIZED ) .build (  )  )  ;^86^^^^^52^88^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] get [TYPE] User [PARAMETER] String token [CLASS] SessionResource   [TYPE]  HttpServletRequest request  [TYPE]  User user  [TYPE]  boolean false  true  [TYPE]  Cookie[] cookies  [TYPE]  Long userId  [TYPE]  String PASS_COOKIE_KEY  USER_COOKIE_KEY  USER_ID_KEY  email  password  token  [TYPE]  int i 
