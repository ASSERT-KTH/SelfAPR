[REPLACE]^public static final String TEXT_CSV ;^44^^^^^^^[REPLACE] public static final String TEXT_CSV = "text/csv";^ [CLASS] PositionResource  
[REPLACE]^public static final String CONTENT_DISPOSITION_VALUE_CSV ;^45^^^^^^^[REPLACE] public static final String CONTENT_DISPOSITION_VALUE_CSV = "attachment; filename=positions.csv";^ [CLASS] PositionResource  
[REPLACE]^public static final String GPX  = null ;^46^^^^^^^[REPLACE] public static final String GPX = "application/gpx+xml";^ [CLASS] PositionResource  
[REPLACE]^public static final String CONTENT_DISPOSITION_VALUE_GPX  = null ;^47^^^^^^^[REPLACE] public static final String CONTENT_DISPOSITION_VALUE_GPX = "attachment; filename=positions.gpx";^ [CLASS] PositionResource  
[REPLACE]^if  ( positionIds.isEmpty (  )  )  {^54^^^^^53^69^[REPLACE] if  ( !positionIds.isEmpty (  )  )  {^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^}  if  ( deviceId  &&  0 )  {^62^^^^^53^69^[REPLACE] } else if  ( deviceId == 0 )  {^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[ADD]^}   return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ;Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , deviceId ) ;^62^63^64^65^66^53^69^[ADD] else if  ( deviceId == 0 )  { return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ; } else { Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , deviceId ) ; return Context.getDataManager (  ) .getPositions (^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDataManager (  )  .getPosition ( positionId )   ) ;^66^67^^^^62^68^[REPLACE] return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( from ) , DateUtil.parseDate ( to )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDeviceManager (  ) .getPositions ( getUserId (  )  ) ;^63^^^^^53^69^[REPLACE] return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDeviceManager (  ) .getPositions ( getUserId (  )  ) ;^63^^^^^53^69^[REPLACE] return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context .getDeviceManager (  )  .getPositions ( deviceId, DateUtil.parseDate ( from ) , DateUtil.parseDate ( TEXT_CSV )  ) ;^66^67^^^^53^69^[REPLACE] return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( from ) , DateUtil.parseDate ( to )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return this;^61^^^^^54^62^[REPLACE] return positions;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[ADD]^^56^57^58^59^60^54^62^[ADD] for  ( Long positionId : positionIds )  { Position position = Context.getDataManager (  ) .getPosition ( positionId ) ; Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , position.getDeviceId (  )  ) ; positions.add ( position ) ; }^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^Position position = Context .getDeviceManager (  )  .getPosition ( positionId ) ;^57^^^^^54^62^[REPLACE] Position position = Context.getDataManager (  ) .getPosition ( positionId ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^}  if  ( deviceId  !=  0 )  {^62^^^^^53^69^[REPLACE] } else if  ( deviceId == 0 )  {^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[ADD]^}   Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , deviceId ) ;^62^63^64^65^66^53^69^[ADD] else if  ( deviceId == 0 )  { return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ; } else { Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , deviceId ) ; return Context.getDataManager (  ) .getPositions (^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( to ) , DateUtil.parseDate ( to )  ) ;^66^67^^^^62^68^[REPLACE] return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( from ) , DateUtil.parseDate ( to )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDeviceManager (  ) .getPositions ( getUserId (  )  ) ;^63^^^^^53^69^[REPLACE] return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[ADD]^^56^57^58^59^60^54^62^[ADD] for  ( Long positionId : positionIds )  { Position position = Context.getDataManager (  ) .getPosition ( positionId ) ; Context.getPermissionsManager (  ) .checkDevice ( getUserId (  ) , position.getDeviceId (  )  ) ; positions.add ( position ) ; }^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return this;^61^^^^^54^62^[REPLACE] return positions;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDeviceManager (  ) .getPositions ( getUserId (  )  ) ;^63^^^^^54^62^[REPLACE] return Context.getDeviceManager (  ) .getInitialState ( getUserId (  )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( to ) , DateUtil.parseDate ( to )  ) ;^66^67^^^^54^62^[REPLACE] return Context.getDataManager (  ) .getPositions ( deviceId, DateUtil.parseDate ( from ) , DateUtil.parseDate ( to )  ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
[REPLACE]^Position position = Context .getDeviceManager (  )  .getPosition ( positionId ) ;^57^^^^^54^62^[REPLACE] Position position = Context.getDataManager (  ) .getPosition ( positionId ) ;^[METHOD] getJson [TYPE] Collection [PARAMETER] QueryParam(value = "deviceId")
long deviceId Long> positionIds String from String to [CLASS] PositionResource   [TYPE]  boolean false  true  [TYPE]  Position position  [TYPE]  ArrayList positions  [TYPE]  Long positionId  [TYPE]  List positionIds  [TYPE]  String CONTENT_DISPOSITION_VALUE_CSV  CONTENT_DISPOSITION_VALUE_GPX  GPX  TEXT_CSV  from  to  [TYPE]  long deviceId 
