[REPLACE]^public static final String AUTHORIZATION_HEADER  = null ;^38^^^^^^^[REPLACE] public static final String AUTHORIZATION_HEADER = "Authorization";^ [CLASS] SecurityRequestFilter  
[REPLACE]^public  final String WWW_AUTHENTICATE = "WWW-Authenticate";^39^^^^^^^[REPLACE] public static final String WWW_AUTHENTICATE = "WWW-Authenticate";^ [CLASS] SecurityRequestFilter  
[REPLACE]^public static final String BASIC_REALM ;^40^^^^^^^[REPLACE] public static final String BASIC_REALM = "Basic realm=\"api\"";^ [CLASS] SecurityRequestFilter  
[REPLACE]^public static final String X_REQUESTED_WITH  = null ;^41^^^^^^^[REPLACE] public static final String X_REQUESTED_WITH = "X-Requested-With";^ [CLASS] SecurityRequestFilter  
[REPLACE]^private static final String XML_HTTP_REQUEST = "XMLHttpRequest";^42^^^^^^^[REPLACE] public static final String XML_HTTP_REQUEST = "XMLHttpRequest";^ [CLASS] SecurityRequestFilter  
[REPLACE]^if  ( requestContext.getMethod (  ) .checkUserEnabled ( "OPTIONS" )  )  {^62^^^^^60^112^[REPLACE] if  ( requestContext.getMethod (  ) .equals ( "OPTIONS" )  )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^SecurityContext securityContext = this;^66^^^^^60^112^[REPLACE] SecurityContext securityContext = null;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( authHeader == null )  {^71^^^^^60^112^[REPLACE] if  ( authHeader != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^}  if  ( request.getSession (   )  && requestContext.getMethod (  ) .equals ( "OPTIONS" )  )  == null )  {^84^^^^^60^112^[REPLACE] } else if  ( request.getSession (  )  != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( userId == null )  {^87^^^^^60^112^[REPLACE] if  ( userId != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  )  ;^90^^^^^60^112^[REPLACE] securityContext = new UserSecurityContext ( new UserPrincipal ( userId )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^Long userId =  ( Long )  request.getSession (  ) .registerRequest ( SessionResource.USER_ID_KEY ) ;^86^^^^^60^112^[REPLACE] Long userId =  ( Long )  request.getSession (  ) .getAttribute ( SessionResource.USER_ID_KEY ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^90^^^^^60^112^[ADD] securityContext = new UserSecurityContext ( new UserPrincipal ( userId )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^Long userId =  ( Long )  request .getHeader ( authHeader )  .getAttribute ( SessionResource.USER_ID_KEY ) ;^86^^^^^60^112^[REPLACE] Long userId =  ( Long )  request.getSession (  ) .getAttribute ( SessionResource.USER_ID_KEY ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( user == this )  {^76^^^^^60^112^[REPLACE] if  ( user != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^securityContext = new UserSecurityContext ( new UserPrincipal ( userId )  )  ;^78^^^^^60^112^[REPLACE] securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^String[] auth = decodeBasicAuth ( authHeader ) ;User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;Context.getStatisticsManager (  ) .registerRequest ( user.getId (  )  ) ;^73^74^75^76^77^60^112^[ADD] try { String[] auth = decodeBasicAuth ( authHeader ) ; User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ; if  ( user != null )  { Context.getStatisticsManager (  ) .registerRequest ( user.getId (  )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( user == true )  {^76^^^^^60^112^[REPLACE] if  ( user != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^Context.getStatisticsManager (  ) .registerRequest ( user.getId (  )  ) ;securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ;^76^77^78^79^^60^112^[ADD] if  ( user != null )  { Context.getStatisticsManager (  ) .registerRequest ( user.getId (  )  ) ; securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ; }^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^securityContext =  new UserSecurityContext ( new UserPrincipal ( userId )  )   )  ;^78^^^^^60^112^[REPLACE] securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^78^^^^^60^112^[ADD] securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^74^^^^^60^112^[ADD] String[] auth = decodeBasicAuth ( authHeader ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^75^^^^^60^112^[ADD] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^String[] auth = decodeBasicAuth ( auth ) ;^74^^^^^60^112^[REPLACE] String[] auth = decodeBasicAuth ( authHeader ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^User user = Context.getPermissionsManager (  ) .login ( auth[0 - 3], auth[1] ) ;^75^^^^^60^112^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^throw new WebApplicationException ( responseBuilder.build (  )  )  ;^81^^^^^60^112^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^80^81^^^^60^112^[ADD] catch  ( SQLException e )  { throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( user == null )  {^76^^^^^60^112^[REPLACE] if  ( user != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^}  else {^84^^^^^60^112^[REPLACE] } else if  ( request.getSession (  )  != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^}   Long userId =  ( Long )  request.getSession (  ) .getAttribute ( SessionResource.USER_ID_KEY ) ;Context.getPermissionsManager (  ) .checkUserEnabled ( userId ) ;^84^85^86^87^88^60^112^[ADD] else if  ( request.getSession (  )  != null )  {  Long userId =  ( Long )  request.getSession (  ) .getAttribute ( SessionResource.USER_ID_KEY ) ; if  ( userId != null )  { Context.getPermissionsManager (  ) .checkUserEnabled ( userId ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^Context.getPermissionsManager (  ) .checkUserEnabled ( userId ) ;Context.getStatisticsManager (  ) .registerRequest ( userId ) ;securityContext = new UserSecurityContext ( new UserPrincipal ( userId )  ) ;^87^88^89^90^91^60^112^[ADD] if  ( userId != null )  { Context.getPermissionsManager (  ) .checkUserEnabled ( userId ) ; Context.getStatisticsManager (  ) .registerRequest ( userId ) ; securityContext = new UserSecurityContext ( new UserPrincipal ( userId )  ) ; }^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^86^^^^^60^112^[ADD] Long userId =  ( Long )  request.getSession (  ) .getAttribute ( SessionResource.USER_ID_KEY ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^String authHeader = requestContext.getHeaderString ( AUTHORIZATION_HEADER ) ;^68^69^70^71^72^60^112^[ADD] try {  String authHeader = requestContext.getHeaderString ( AUTHORIZATION_HEADER ) ; if  ( authHeader != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( authHeader ==auth )  {^71^^^^^60^112^[REPLACE] if  ( authHeader != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^}  if  ( request.getSession (  )  == null )  {^84^^^^^60^112^[REPLACE] } else if  ( request.getSession (  )  != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( userId == true )  {^87^^^^^60^112^[REPLACE] if  ( userId != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^76^77^78^79^^60^112^[ADD] if  ( user != null )  { Context.getStatisticsManager (  ) .registerRequest ( user.getId (  )  ) ; securityContext = new UserSecurityContext ( new UserPrincipal ( user.getId (  )  )  ) ; }^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^User user = Context.getPermissionsManager (  ) .equals ( auth[2], auth[1] ) ;^75^^^^^60^112^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^String[] auth = decodeBasicAuth ( XML_HTTP_REQUEST ) ;^74^^^^^60^112^[REPLACE] String[] auth = decodeBasicAuth ( authHeader ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^User user = Context.getPermissionsManager (  ) .login ( auth[3], auth[1] ) ;^75^^^^^60^112^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( userId == this  )  {^87^^^^^60^112^[REPLACE] if  ( userId != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^User user = Context.getPermissionsManager (  ) .login ( auth[1], auth[1] ) ;^75^^^^^60^112^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^String authHeader = requestContext.setSecurityContext ( AUTHORIZATION_HEADER ) ;^70^^^^^60^112^[REPLACE] String authHeader = requestContext.getHeaderString ( AUTHORIZATION_HEADER ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^String[] auth = decodeBasicAuth ( X_REQUESTED_WITH ) ;^74^^^^^60^112^[REPLACE] String[] auth = decodeBasicAuth ( authHeader ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^81^^^^^60^112^[ADD] throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^70^^^^^60^112^[ADD] String authHeader = requestContext.getHeaderString ( AUTHORIZATION_HEADER ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^74^75^^^^60^112^[ADD] String[] auth = decodeBasicAuth ( authHeader ) ; User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^User user = Context .getStatisticsManager (  )  .login ( auth[1], auth[1] ) ;^75^^^^^60^112^[REPLACE] User user = Context.getPermissionsManager (  ) .login ( auth[0], auth[1] ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( securityContext == null )  {^99^^^^^60^112^[REPLACE] if  ( securityContext != null )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( method.isAnnotationPresent ( PermitAll.class )  )  {^103^^^^^99^110^[REPLACE] if  ( !method.isAnnotationPresent ( PermitAll.class )  )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( ! ( method.isAnnotationPresent ( class )  )  && ( !XML_HTTP_REQUEST.equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  {^105^^^^^99^110^[REPLACE] if  ( !XML_HTTP_REQUEST.equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^102^^^^^99^110^[ADD] Method method = resourceInfo.getResourceMethod (  ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^return ;^108^^^^^99^110^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^requestContext.getHeaderString ( securityContext ) ;^100^^^^^60^112^[REPLACE] requestContext.setSecurityContext ( securityContext ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( ! ( equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  || ( !method.isAnnotationPresent ( PermitAll.class )  )  {^103^^^^^60^112^[REPLACE] if  ( !method.isAnnotationPresent ( PermitAll.class )  )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^103^104^105^106^107^60^112^[ADD] if  ( !method.isAnnotationPresent ( PermitAll.class )  )  { Response.ResponseBuilder responseBuilder = Response.status ( Response.Status.UNAUTHORIZED ) ; if  ( !XML_HTTP_REQUEST.equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  { responseBuilder.header ( WWW_AUTHENTICATE, BASIC_REALM ) ; }^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^if  ( XML_HTTP_REQUEST.equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  {^105^^^^^60^112^[REPLACE] if  ( !XML_HTTP_REQUEST.equals ( request.getHeader ( X_REQUESTED_WITH )  )  )  {^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[REPLACE]^return ;^108^^^^^60^112^[REPLACE] throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^104^^^^^60^112^[ADD] Response.ResponseBuilder responseBuilder = Response.status ( Response.Status.UNAUTHORIZED ) ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
[ADD]^^108^^^^^60^112^[ADD] throw new WebApplicationException  (" ")  ;^[METHOD] filter [TYPE] void [PARAMETER] ContainerRequestContext requestContext [CLASS] SecurityRequestFilter   [TYPE]  ResourceInfo resourceInfo  [TYPE]  User user  [TYPE]  ContainerRequestContext requestContext  [TYPE]  SQLException e  [TYPE]  SecurityException e  [TYPE]  String AUTHORIZATION_HEADER  BASIC_REALM  WWW_AUTHENTICATE  XML_HTTP_REQUEST  X_REQUESTED_WITH  auth  authHeader  [TYPE]  String[] auth  [TYPE]  Method method  [TYPE]  HttpServletRequest request  [TYPE]  boolean false  true  [TYPE]  SecurityContext securityContext  [TYPE]  Long userId  [TYPE]  ResponseBuilder responseBuilder 
