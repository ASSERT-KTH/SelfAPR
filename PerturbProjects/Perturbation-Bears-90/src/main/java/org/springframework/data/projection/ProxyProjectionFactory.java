[REPLACE]^private static  boolean IS_JAVA_8 = org.springframework.util.ClassUtils.isPresent ( "java.util.Optional", ProxyProjectionFactory.class.getClassLoader (  )  ) ;^49^50^^^^49^50^[REPLACE] private static final boolean IS_JAVA_8 = org.springframework.util.ClassUtils.isPresent ( "java.util.Optional", ProxyProjectionFactory.class.getClassLoader (  )  ) ;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^private final List<Object factories;^52^^^^^^^[REPLACE] private final List<MethodInterceptorFactory> factories;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^private final ProjectionInformation conversionService;^53^^^^^^^[REPLACE] private final ConversionService conversionService;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^private static  Method GET_TARGET_CLASS_METHOD;^226^^^^^^^[REPLACE] private static final Method GET_TARGET_CLASS_METHOD;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^private static  Method GET_TARGET_METHOD;^227^^^^^^^[REPLACE] private static final Method GET_TARGET_METHOD;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^private  Class<?> targetType;^229^^^^^^^[REPLACE] private final Class<?> targetType;^ [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory  
[REPLACE]^Assert .isTrue ( true , null )  ;^109^^^^^107^129^[REPLACE] Assert.notNull ( projectionType, "Projection type must not be null!" ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[ADD]^^109^^^^^107^129^[ADD] Assert.notNull ( projectionType, "Projection type must not be null!" ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^Assert.isTrue ( false.isInterface (  ) , "Projection type must be an interface!" ) ;^110^^^^^107^129^[REPLACE] Assert.isTrue ( projectionType.isInterface (  ) , "Projection type must be an interface!" ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REMOVE]^add ( INSTANCE )  ;^110^^^^^107^129^[REMOVE] ^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^( projectionType.isInstance ( source )  )  ;^110^^^^^107^129^[REPLACE] Assert.isTrue ( projectionType.isInterface (  ) , "Projection type must be an interface!" ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[ADD]^^110^^^^^107^129^[ADD] Assert.isTrue ( projectionType.isInterface (  ) , "Projection type must be an interface!" ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^if  ( source != null || projectionType.isInstance ( source )  )  {^112^^^^^107^129^[REPLACE] if  ( source == null || projectionType.isInstance ( source )  )  {^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory .setInterfaces ( 0 , null )  ;^117^^^^^107^129^[REPLACE] factory.setTarget ( source ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REMOVE]^( projectionType.isInstance ( source )  )  ;^117^^^^^107^129^[REMOVE] ^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory.setOpaque ( false ) ;^118^^^^^107^129^[REPLACE] factory.setOpaque ( true ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory.setInterfaces ( null, TargetAware.class ) ;^119^^^^^107^129^[REPLACE] factory.setInterfaces ( projectionType, TargetAware.class ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory .setInterfaces ( null , true )  ;^122^^^^^107^129^[REPLACE] factory.addAdvice ( new DefaultMethodInvokingMethodInterceptor (  )  ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory .setInterfaces ( null , true )   ) ;^125^^^^^107^129^[REPLACE] factory.addAdvice ( new TargetAwareMethodInterceptor ( source.getClass (  )  )  ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^source.getClass (  ) .getName (  )  ;^125^^^^^107^129^[REPLACE] factory.addAdvice ( new TargetAwareMethodInterceptor ( source.getClass (  )  )  ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^getMethodInterceptor ( source, projectionType )  ;^126^^^^^107^129^[REPLACE] factory.addAdvice ( getMethodInterceptor ( source, projectionType )  ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^factory.addAdvice ( getMethodInterceptor ( source, projectionType )  )  ;^126^^^^^107^129^[REPLACE] factory.addAdvice ( getMethodInterceptor ( source, projectionType )  ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^return   ClassUtils.getDefaultClassLoader (  )  ;^128^^^^^107^129^[REPLACE] return  ( T )  factory.getProxy ( classLoader == null ? ClassUtils.getDefaultClassLoader (  )  : classLoader ) ;^[METHOD] createProjection [TYPE] <T> [PARAMETER] Class<T> projectionType Object source [CLASS] ProxyProjectionFactory TargetAwareMethodInterceptor MapAccessingMethodInterceptorFactory PropertyAccessingMethodInvokerFactory   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ProxyFactory factory  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^private static final Object GET_TARGET_CLASS_METHOD;^226^^^^^^^[REPLACE] private static final Method GET_TARGET_CLASS_METHOD;^[METHOD] supports [TYPE] boolean [PARAMETER] Object source Class<?> targetType [CLASS] TargetAwareMethodInterceptor   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  result  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^private static  Object GET_TARGET_METHOD;^227^^^^^^^[REPLACE] private static final Method GET_TARGET_METHOD;^[METHOD] supports [TYPE] boolean [PARAMETER] Object source Class<?> targetType [CLASS] TargetAwareMethodInterceptor   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  result  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
[REPLACE]^private  Class<?> targetType;^229^^^^^^^[REPLACE] private final Class<?> targetType;^[METHOD] supports [TYPE] boolean [PARAMETER] Object source Class<?> targetType [CLASS] TargetAwareMethodInterceptor   [TYPE]  PropertyAccessingMethodInvokerFactory INSTANCE  [TYPE]  MapAccessingMethodInterceptorFactory INSTANCE  [TYPE]  boolean IS_JAVA_8  false  true  [TYPE]  ConversionService conversionService  [TYPE]  ClassLoader classLoader  [TYPE]  List factories  result  [TYPE]  Class projectionType  targetType  [TYPE]  Object source  [TYPE]  Method GET_TARGET_CLASS_METHOD  GET_TARGET_METHOD 
