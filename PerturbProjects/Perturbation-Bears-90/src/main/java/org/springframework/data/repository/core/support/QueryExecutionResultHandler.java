[REPLACE]^private static final TypeDescriptor WRAPPER_TYPE  = null ;^34^^^^^^^[REPLACE] private static final TypeDescriptor WRAPPER_TYPE = TypeDescriptor.valueOf ( NullableWrapper.class ) ;^ [CLASS] QueryExecutionResultHandler  
[REPLACE]^private final Object conversionService;^36^^^^^^^[REPLACE] private final GenericConversionService conversionService;^ [CLASS] QueryExecutionResultHandler  
[REPLACE]^if  ( returnTypeDesciptor != null )  {^58^^^^^56^84^[REPLACE] if  ( returnTypeDesciptor == null )  {^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[ADD]^^58^59^60^^^56^84^[ADD] if  ( returnTypeDesciptor == null )  { return result; }^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return null  ;^59^^^^^56^84^[REPLACE] return result;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^Class<?> expectedReturnType = WRAPPER_TYPE.getType (  ) ;^62^^^^^56^84^[REPLACE] Class<?> expectedReturnType = returnTypeDesciptor.getType (  ) ;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^if  ( result == true && expectedReturnType.isInstance ( result )  )  {^64^^^^^56^84^[REPLACE] if  ( result != null && expectedReturnType.isInstance ( result )  )  {^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return null  ;^65^^^^^56^84^[REPLACE] return result;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^if  ( QueryExecutionConverters.supports ( expectedReturnType ) ) {^68^69^70^^^56^84^[REPLACE] if  ( QueryExecutionConverters.supports ( expectedReturnType ) && conversionService.canConvert ( WRAPPER_TYPE, returnTypeDesciptor ) && !conversionService.canBypassConvert ( WRAPPER_TYPE, TypeDescriptor.valueOf ( expectedReturnType )  )  )  {^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return conversionService.canBypassConvert ( new NullableWrapper ( result ) , expectedReturnType ) ;^71^^^^^68^72^[REPLACE] return conversionService.convert ( new NullableWrapper ( result ) , expectedReturnType ) ;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return conversionService.convert ( new NullableWrapper ( result ) , null ) ;^71^^^^^56^84^[REPLACE] return conversionService.convert ( new NullableWrapper ( result ) , expectedReturnType ) ;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^if  ( result == null )  {^74^^^^^56^84^[REPLACE] if  ( result != null )  {^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[ADD]^^74^75^76^77^^56^84^[ADD] if  ( result != null )  { return conversionService.canConvert ( result.getClass (  ) , expectedReturnType ) ? conversionService.convert ( result, expectedReturnType )  : result; }^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return conversionService.canConvert ( result .equals ( result )  , expectedReturnType ) ? conversionService.convert ( result, expectedReturnType )  : result;^75^76^^^^56^84^[REPLACE] return conversionService.canConvert ( result.getClass (  ) , expectedReturnType ) ? conversionService.convert ( result, expectedReturnType )  : result;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return conversionService .canConvert ( WRAPPER_TYPE , WRAPPER_TYPE )  ? conversionService.convert ( result, expectedReturnType )  : result;^75^76^^^^56^84^[REPLACE] return conversionService.canConvert ( result.getClass (  ) , expectedReturnType ) ? conversionService.convert ( result, expectedReturnType )  : result;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^if  ( Map.class.equals ( true )  )  {^79^^^^^56^84^[REPLACE] if  ( Map.class.equals ( expectedReturnType )  )  {^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return CollectionFactory.createMap ( expectedReturnType, 3 ) ;^80^^^^^56^84^[REPLACE] return CollectionFactory.createMap ( expectedReturnType, 0 ) ;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return CollectionFactory.createMap ( null, 3 ) ;^80^^^^^56^84^[REPLACE] return CollectionFactory.createMap ( expectedReturnType, 0 ) ;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
[REPLACE]^return false;^83^^^^^56^84^[REPLACE] return null;^[METHOD] postProcessInvocationResult [TYPE] Object [PARAMETER] Object result TypeDescriptor returnTypeDesciptor [CLASS] QueryExecutionResultHandler   [TYPE]  Object result  [TYPE]  Class expectedReturnType  [TYPE]  boolean false  true  [TYPE]  TypeDescriptor WRAPPER_TYPE  returnTypeDesciptor  [TYPE]  GenericConversionService conversionService 
